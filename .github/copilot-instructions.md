- Look for AGENTS.md on the projects and update it with relevant context history.
- Look for TODO.md on the projects and update it with relevant context history.
- Update your suggestions on TODO.md tasks.
- USE .NET 9.0 and C# 13 features.
- Follow existing coding style and conventions in the codebase.
- Run formatting tools 
- Write clear, maintainable, and well-documented code.
- Build before testing (use one command dotnet build ...; dotnet test ...).
- Do NOT modify generated files directly. These files will include a marker such as a header comment with `// <auto-generated/>` or files using the pattern `<generated>` in the name. Treat those as read-only.
- Prefer immutability and `readonly` fields where meaningful.
- Split large methods in smaller helper methods for clarity.
- Never commit to git.
- Do NOT use @" strings.
- Changes in doc (.md files) doesn't require compile and test.
- When you find something difficult, ask the operator for clarification.

Source generation style guidelines (required)
-----------------------------------
When building multi-line code snippets for source generators:
1. Use raw interpolated string literals in block format:
   ```csharp
   srcBuilder.Append($$"""
       {{variable}}.MethodCall();
       
       """);
   ```
2. Generate snippets WITHOUT embedded indentation (no leading spaces inside the raw string). This is required for consistency and to avoid fragile leading whitespace in generated artifacts.
3. Apply indentation at template inclusion time using `.FixIndent(levels)` where `levels` is the number of indentation levels (4 spaces per level). Each generator project must provide or reuse a `FixIndent` helper (string/StringBuilder ext.) so templates can be composed consistently.
   ```csharp
   var source = $$"""
      namespace {{ns}}
      {
         {{srcBuilder.FixIndent(1)}} // 1 level == 4 spaces
      }
      """;
   ```
4. The `FixIndent` extension normalizes line endings and prefixes non-empty lines with the specified indentation (levels * 4 spaces).

5. Use file-scoped namespaces in generated files where possible (C# 10+ style):
   - Emit `namespace {{ns}};` at the top of generated files instead of block-style `namespace {{ns}} { ... }` when the generated file's content does not require nested scope. This produces cleaner output and avoids extra indentation.

Important enforcement and local project guidance
-----------------------------------------------
- This repository's canonical policy is the section above. All generators across the workspace MUST follow this template style.
- If a project's `AGENTS.md` or `TODO.md` suggests an alternative approach to embedding multi-line generated source, update that file to match this policy or remove contradictory guidance so the project falls back to this global instruction.
- When you add or update a generator, ensure:
   - You use $$""" raw interpolated templates for blocks of generated source.
   - Snippets inside templates are not indented (no leading whitespace) — use `.FixIndent()` on the final inclusion site.
   - You add or reuse a `FixIndent` helper in the generator project (string/StringBuilder extension) if one doesn't already exist.
   - Avoid manual string concatenation for multi-line blocks — raw templates are clearer and safer.

If uncertain, prefer the global policy in this file and update local AGENTS.md/TODO.md to match.

Generator output naming conventions (recommended)
-----------------------------------------------
- Prefer generated file names that match the primary type being generated to make it easier to map artifacts back to source types and avoid collisions. Example:
   - Endpoint generators should emit `Endpoint{TypeName}.g.cs` for normal endpoints.
   - If an attribute includes a naming exception/justification (e.g., `NamingExceptionJustification`) and the declared type name might collide, consider emitting a namespace-qualified file name `{{FullNamespace}}.{{TypeName}}.g.cs` to disambiguate.
- Avoid emitting additional marker classes or duplicate placeholder types unless they serve a specific compatibility purpose.

AI agent verification checklist
------------------------------
1. Environment & SDK check
   - Ensure `dotnet --list-sdks` includes .NET 9.0 or above.
   - Abort if no supported SDK is detected.

2. Build & test
   - Run `dotnet build && dotnet test` and fail if there are build/test errors.

3. Sanitization & security
   - Do not interpolate untrusted input into generated source. Always sanitize or validate input.